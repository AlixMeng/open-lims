<script type="text/javascript">
/*<![CDATA[*/
$(document).ready(function()
{
	function check_form()
	{
		var no_error = true;
		
		if ($(".FormTextfield[name='forename']").val() === "")
		{
			no_error = false;
			$("#Error1").html("<br />[[LANG:BaseUserPersonalError1]]");
		}
		
		if ($(".FormTextfield[name='surname']").val() === "")
		{
			no_error = false;
			$("#Error2").html("<br />[[LANG:BaseUserPersonalError2]]");
		}
		
		if ($(".FormTextfield[name='mail']").val() === "")
		{
			no_error = false;
			$("#Error3").html("<br />[[LANG:BaseUserPersonalError3]]");
		}
		else
		{
			if (!is_mail_address_valid($(".FormTextfield[name='mail']").val()))
			{
				no_error = false;
				$("#Error3").html("<br />[[LANG:BaseUserPersonalError3]]");
			}
		}
		
		if ($(".FormTextfield[name='icq']").val() !== "")
		{
			if (isNaN(parseInt($(".FormTextfield[name='icq']").val())))
			{
				no_error = false;
				$("#Error4").html("<br />[[LANG:BaseUserPersonalError4]]");
			}
		}
		
		return no_error;
	}
	
	$("#BaseUserProfilePersonalDataCancelButton").click(function()
	{
		history.back();
	});    
  
	
	$("#BaseUserProfilePersonalDataSaveButton").click(function()
	{
		if (check_form() === true)
		{			
			var gender = $(":radio:checked[name='gender']").val();
			var forename = $(".FormTextfield[name='forename']").val();
			var surname = $(".FormTextfield[name='surname']").val();
			var title = $(".FormTextfield[name='title']").val();
			var mail = $(".FormTextfield[name='mail']").val();
			var institution = $(".FormTextfield[name='institution']").val();
			var department = $(".FormTextfield[name='department']").val();
			var street = $(".FormTextfield[name='street']").val();
			var zip = $(".FormTextfield[name='zip']").val();
			var city = $(".FormTextfield[name='city']").val();
			var country = $(".FormTextfield[name='country']").val();
			var phone = $(".FormTextfield[name='phone']").val();
			var icq = $(".FormTextfield[name='icq']").val();
			var msn = $(".FormTextfield[name='msn']").val();
			var yahoo = $(".FormTextfield[name='yahoo']").val();
			var aim = $(".FormTextfield[name='aim']").val();
			var skype = $(".FormTextfield[name='skype']").val();
			var lync = $(".FormTextfield[name='lync']").val();
			var jabber = $(".FormTextfield[name='jabber']").val();
			
			$.ajax(
			{
				type : "POST",
				url : "ajax.php?session_id=[[SESSION_ID]]&nav=base&run=user_profile_personal_data_change",
				data : "gender="+gender+"&forename="+forename+"&surname="+surname+"&title="+title+"&mail="+mail+"&institution="+institution+"&department="+department+"&street="+street+"&zip="+zip+"&city="+city+"&country="+country+"&phone="+phone+"&icq="+icq+"&msn="+msn+"&yahoo="+yahoo+"&aim="+aim+"&skype="+skype+"&lync="+lync+"&jabber="+jabber+"",
				beforeSend: function()
				{
					$("#BaseUserProfilePersonalDataFinish").dialog("open");
				},
				success : function(data)
				{
					if (data == "1")
					{
						window.setTimeout('window.location = \'[[RETRACE]]\'',500);
					}
					else
					{
						if ((data + '').indexOf("EXCEPTION",0) === 0)
						{
							var exception_message = data.replace("EXCEPTION: ","");
							$("#BaseUserProfilePersonalDataFinish").dialog("close");
							ErrorDialog("Error", exception_message);
							return false;
						}
						else
						{
							$("#BaseUserProfilePersonalDataFinish").dialog("close");
							ErrorDialog("Error", "An error occured");
							return false;
						}
					}
				}
			});
		}
	});	
});
/*]]>*/           
</script>

<div class="BasePlaseWaitWindow" id="BaseUserProfilePersonalDataFinish" title=""> 
<div><img src='images/animations/loading_circle_small.gif' alt=''> [[LANG:BaseGlobalMessageWait]]</div>
</div> 

<!-- CONTAINER BEGIN ("[[LANG:BaseUserPersonalTitle]]") -->

<div class='Form'>
<div class='FormBox'>
<div class='FormBoxHeadline'>[[LANG:BaseUserPersonalPersonalTitle]]</div>

<table style='width: 100%'>
	<tr>
		<td style='width: 30%;'>[[LANG:BaseUserPersonalGender]]:</td>
		<td>
		
			<!-- IF ([[GENDER]]) -->
		
			<input name='gender' type='radio' value='m' checked />[[LANG:BaseUserPersonalGenderMale]]&nbsp;
			<input name='gender' type='radio' value='f' />[[LANG:BaseUserPersonalGenderFemale]]
			
			<!-- ELSE -->
			
			<input name='gender' type='radio' value='m' />[[LANG:BaseUserPersonalGenderMale]]&nbsp;
			<input name='gender' type='radio' value='f' checked />[[LANG:BaseUserPersonalGenderFemale]]
			
			<!-- ENDIF -->
						
		</td>
	</tr>
	<tr>
		<td>[[LANG:BaseUserPersonalFirstName]]: *</td>
		<td>
			<input type='text' name='forename' value='[[FORENAME]]' class='FormTextfield' size='45' />
			<span class='FormError' id='Error1'></span>
		</td>
	</tr>
	<tr>
		<td>[[LANG:BaseUserPersonalLastName]]: *</td>
		<td>
			<input type='text' name='surname' value='[[SURNAME]]' class='FormTextfield' size='45' />
			<span class='FormError' id='Error2'></span>	
		</td>
	</tr>
	<tr>
		<td>[[LANG:BaseUserPersonalPTitle]]:</td>
		<td><input type='text' name='title' value='[[TITLE]]' class='FormTextfield' size='45' maxlength='10' /></td>
	</tr>
	
</table>

<div class='FormBoxClear'></div>
</div>


<div class='FormBox'>
<div class='FormBoxHeadline'>[[LANG:BaseUserPersonalContactTitle]]</div>

<table style='width: 100%'>

	<tr>
		<td style='width: 30%;'>[[LANG:BaseUserPersonalMail]]: *</td>
		<td>
			<input type='text' name='mail' value='[[MAIL]]' class='FormTextfield' id='BaseUserProfilePersonalDataMail' size='45' />
			<span class='FormError' id='Error3'></span>
		</td>
	</tr>
	<tr>
		<td>[[LANG:BaseUserPersonalInstitution]]:</td>
		<td><input type='text' name='institution' value='[[INSTITUTION]]' class='FormTextfield' size='45' /></td>
	</tr>
	<tr>
		<td>[[LANG:BaseUserPersonalDepartment]]:</td>
		<td><input type='text' name='department' value='[[DEPARTMENT]]' class='FormTextfield' size='45' /></td>
	</tr>
	<tr>
		<td>[[LANG:BaseUserPersonalStreet]]:</td>
		<td><input type='text' name='street' value='[[STREET]]' class='FormTextfield' size='45' /></td>
	</tr>
	<tr>
		<td>[[LANG:BaseUserPersonalZip]]:</td>
		<td><input type='text' name='zip' value='[[ZIP]]' class='FormTextfield' size='10' maxlength='10' /></td>
	</tr>
	<tr>
		<td>[[LANG:BaseUserPersonalCity]]:</td>
		<td><input type='text' name='city' value='[[CITY]]' class='FormTextfield' size='45' /></td>
	</tr>
	<tr>
		<td>[[LANG:BaseUserPersonalCountry]]:</td>
		<td><input type='text' name='country' value='[[COUNTRY]]' class='FormTextfield' size='45' /></td>
	</tr>
	<tr>
		<td>[[LANG:BaseUserPersonalPhone]]:</td>
		<td><input type='text' name='phone' value='[[PHONE]]' class='FormTextfield' size='45' /></td>
	</tr>
	
</table>

<div class='FormBoxClear'></div>
</div>


<div class='FormBox'>
<div class='FormBoxHeadline'>[[LANG:BaseUserPersonalInstantMessengerTitle]]</div>

<table style='width: 100%'>
	
	<tr>
		<td style='width: 30%;'>[[LANG:BaseUserPersonalICQ]]:</td>
		<td>
			<input type='text' name='icq' value='[[ICQ]]' class='FormTextfield' size='45' />
			<span class='FormError' id='Error4'></span>
		</td>
	</tr>
	<tr>
		<td>[[LANG:BaseUserPersonalMSN]]:</td>
		<td><input type='text' name='msn' value='[[MSN]]' class='FormTextfield' size='45' /></td>
	</tr>
	<tr>
		<td>[[LANG:BaseUserPersonalYahoo]]:</td>
		<td><input type='text' name='yahoo' value='[[YAHOO]]' class='FormTextfield' size='45' /></td>
	</tr>
	<tr>
		<td>[[LANG:BaseUserPersonalAIM]]:</td>
		<td><input type='text' name='aim' value='[[AIM]]' class='FormTextfield' size='45' /></td>
	</tr>
	<tr>
		<td>[[LANG:BaseUserPersonalSkype]]:</td>
		<td><input type='text' name='skype' value='[[SKYPE]]' class='FormTextfield' size='45' /></td>
	</tr>
	<tr>
		<td>[[LANG:BaseUserPersonalLync]]:</td>
		<td><input type='text' name='lync' value='[[LYNC]]' class='FormTextfield' size='45' /></td>
	</tr>
	<tr>
		<td>[[LANG:BaseUserPersonalJabber]]:</td>
		<td><input type='text' name='jabber' value='[[JABBER]]' class='FormTextfield' size='45' /></td>
	</tr>
</table>

<div class='FormBoxClear'></div>
</div>



<div class='FormButtonBox'>
<button type='submit' id='BaseUserProfilePersonalDataSaveButton'>[[LANG:BaseGlobalButtonSave]]</button>
<button type='submit' id='BaseUserProfilePersonalDataCancelButton'>[[LANG:BaseGlobalButtonCancel]]</button>
<div class='FormButtonBoxClear'></div>
</div>
</div>

<br /><div class='center'><span class='smallTextBlack'>* [[LANG:BaseUserPersonalRequiredFields]]</span></div>
<br />

					
<!-- CONTAINER END () -->
			
