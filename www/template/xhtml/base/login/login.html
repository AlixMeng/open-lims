<script>
$(document).ready(function()
{
	$('#BaseLoginUsername').bind('keypress', function(e)
	{
        if(e.keyCode == 13)
        {
        	login();
        }
	});

	$('#BaseLoginPassword').bind('keypress', function(e)
	{
        if(e.keyCode == 13)
        {
        	login();
        }
	});

	
	$('#BaseLoginLogin').click(function()
	{
		login();
	});

	function login()
	{
		$.blockUI({ message: $('#BaseLoginWindow'), css: { width: '275px' } }); 
		$('.blockUI.blockMsg').center();

		$("#BaseLoginWindow").html("<img src='images/animations/loading_circle_small.gif' alt=''> Please wait...");
			
		$.ajax(
		{
			type: "POST",
			url: "ajax.php?nav=base&run=login",
			data: "username="+$("#BaseLoginUsername").val()+"&password="+$("#BaseLoginPassword").val()+"&language="+$("#BaseLoginLanguage").val()+"",
			success: function(data)
			{
				if ((data != '0') && ((data + '').indexOf("index.php?",0) == 0))
				{
					$("#BaseLoginError").html("");
					window.setTimeout('window.location = "'+data+'"',1500);
				}
				else
				{
					if (data != 0)
					{
						$("#BaseLoginError").html(data);
					}
					else
					{
						$("#BaseLoginError").html("");
					}
					$.unblockUI();
				    return false; 
				}
			}
		}); 
	}
});
</script>

<div id="LoginWrapper">
	<div id="LoginContainer" class="Form">
		<div id='LoginTitle'>[[LANG:BaseLoginTitle]]</div>
		<table id='LoginTable'>
			<tr>
				<td>[[LANG:BaseLoginUsername]]:</td>
				<td><input name='username' type='text' size='20' class='BaseTextfield LoginTextfield' id='BaseLoginUsername' /></td>
			</tr>
			<tr>
				<td>[[LANG:BaseLoginPassword]]:</td>
				<td><input name='password' type='password' size='20' class='BaseTextfield LoginTextfield' id='BaseLoginPassword' /></td>
			</tr>
			<tr>
				<td>[[LANG:BaseLoginLanguage]]:</td>
				<td>
					<form action="index.php" method="get">
						<select class='BaseSelect LoginLanguageSelect' name='language_id' id='BaseLoginLanguage' onChange="this.form.submit()">
							<option value='default' selected='selected'>[[LANG:BaseLoginLanguageDefault]]</option>
							<option value='0'>-------------</option>
							
							<!-- FOREACH BEGIN ([[LANGUAGES]]) -->
			
							<option value='[[LANGUAGES:OPTION]]' [[LANGUAGES:SELECTED]]>[[LANGUAGES:NAME]]</option>
					
							<!-- FOREACH END -->
						</select>
					</form>
				</td>
			</tr>
			<tr>
				<td colspan='2'><div class='formError' id='BaseLoginError'></div></td>
			</tr>
			<tr>
				<td></td>
				<td><button type='submit' name='submit' id='BaseLoginLogin'>[[LANG:BaseLoginButton]]</button></td>
			</tr>
			
		</table>
	</div>
</div>
<div id="LoginFooter">
[[PRODUCT]], version: [[PRODUCT_VERSION]], [[FUNCTION]], [[USER]]
<br />This is free software; It comes with ABSOLUTELY NO WARRANTY.
<br />Copyright &copy; 2008-2013 by R. Konertz, B. Tunggal, L. Eichinger et al.
<br />Licensed under General Public License, Version 3 (GPL v3)
<br />Go to <a href='http://www.open-lims.org'>http://www.open-lims.org</a> for details
</div>

<div id="BaseLoginWindow" class="BaseBlockUIProceed" style="display:none; cursor: default">
</div>

